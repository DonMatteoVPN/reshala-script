#!/bin/bash
# TITLE: Кто сейчас на сервере (SSH)
# Виджет показывает сколько активных SSH/tty‑сессий и кто именно залогинен.
#
# КАК НАСТРОИТЬ ПОД СЕБЯ:
#   - Если хочешь показывать только количество без имён — убери часть с `$USERS_LIST` в echo.
#   - Если хочешь фильтровать каких‑то пользователей — правь обработку вывода `who`.
#   - Лейбл "Кто на сервере  :" можно сменить на любой другой.

COUNT=$(who 2>/dev/null | wc -l | xargs)

if [ -z "$COUNT" ] || [ "$COUNT" = "0" ]; then
  echo "Кто на сервере  : никто, тишина"
  exit 0
fi

USERS_LIST=$(who 2>/dev/null | awk '{print $1}' | sort -u | tr '\n' ' ' | sed 's/ $//')
echo "Кто на сервере  : $COUNT сессий ($USERS_LIST)"
