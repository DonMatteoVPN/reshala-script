# Remnawave в Решале: понятная установка и управление

Этот документ для тех, кто хочет поставить Remnawave через «Решалу» и спокойно с ним жить,
не вникая в технические детали.

- Где в меню всё это лежит.
- Какие есть сценарии установки.
- Что происходит «под капотом» простыми словами.
- Как пользоваться панелью и нодами после установки.

---

## 1. Где искать Remnawave в меню Решалы

1. Запусти Решалу на сервере:
   ```bash
   sudo reshala
   ```
2. В главном меню выбери пункт:
   ```
   [4] REMNAWAVE: УСТАНОВКА И УПРАВЛЕНИЕ
   ```

Откроется центральное меню Remnawave.

В нём есть несколько разделов:

1. **Установка компонентов Remnawave** — все мастера установки (панель, панель+нода, только ноды).
2. **Переустановить панель/ноду** — аккуратная переустановка уже настроенной панели или ноды.
3. **Управление панелью/нодой** — запустить, остановить, обновить и посмотреть логи.
4. **Шаблоны для маскировки selfsteal‑ноды** — случайные сайты для маскировки трафика.
5. **Кастомные подписки от Legiz** — оформление страницы подписки и список приложений.
6. **Управление сертификатами Remnawave** — отдельное меню для проверки доменов и TLS‑сертификатов.

---

## 2. Типовые сценарии установки

### 2.1. Всё на одном сервере: панель + нода

Подходит, если:
- у тебя один основной сервер,
- ты хочешь и панель, и рабочую ноду на нём же.

**Путь в меню:**

1. `[4] REMNAWAVE: УСТАНОВКА И УПРАВЛЕНИЕ`.
2. `Установка компонентов Remnawave`.
3. Пункт `Панель + нода на один сервер`.

**Что тебя спросят:**

- Домен панели (куда будешь заходить в админку).
- Домен страницы подписки (куда будут заходить пользователи, чтобы брать конфиги).
- Домен ноды (selfsteal, куда смотрит клиентский трафик).
- Логин администратора панели.

Скрипт проверит, правильно ли домены смотрят на этот сервер, и подскажет, если что‑то не так.

**Что сделает Решала:**

- Подготовит каталог `/opt/remnawave`.
- Сгенерирует `.env` и `docker-compose.yml` для панели и первой ноды.
- Создаст временную конфигурацию nginx и поднимет контейнеры.
- Через HTTP‑запросы в панель:
  - зарегистрирует администратора,
  - создаст внутренний профиль под домен ноды,
  - создаст ноду и привяжет её к нужному домену.
- Спросит, нужно ли сразу сделать https (Let's Encrypt). Если согласишься:
  - выпишет бесплатные сертификаты для нужных доменов,
  - обновит настройки nginx под https.

В конце ты увидишь:

- ссылку на панель,
- логин и пароль администратора,
- используемые домены.

### 2.2. Отдельная панель, ноды будут позже

Подходит, если:
- панель будет на отдельном сервере,
- ноды ты планируешь поставить на другие машины позже.

**Путь в меню:**

1. `[4] REMNAWAVE: УСТАНОВКА И УПРАВЛЕНИЕ`.
2. `Установка компонентов Remnawave`.
3. Пункт `Только панель`.

**Что делает мастер:**

- Спрашивает домен панели и домен страницы подписки.
- Резервирует домен для будущей ноды (selfsteal), чтобы сразу всё правильно завести в панели.
- Поднимает только панель и страницу подписки (без локальной ноды).
- Заводит администратора и создаёт «пустую» ноду в настройках панели под будущий домен.
- По желанию сразу включает https.

Дальше на других серверах ты будешь запускать установку нод под эту панель (см. следующий пункт).

### 2.3. Нода под уже готовую панель (на этом сервере)

Подходит, если:
- панель уже где‑то работает,
- ты хочешь поднять **ещё одну ноду** на текущем сервере.

**Путь в меню:**

1. `[4] REMNAWAVE: УСТАНОВКА И УПРАВЛЕНИЕ`.
2. `Установка компонентов Remnawave`.
3. Пункт `Только нода (локально под уже подготовленную панель)`.

**Мастер спросит:**

- адрес панели (URL или `host:port`),
- API‑токен панели (создаётся в интерфейсе Remnawave),
- домен ноды (selfsteal),
- удобное имя ноды в панели.

Дальше сценарий похож: 
панель проверяется, создаётся конфигурация под домен ноды, сама нода регистрируется в панели и разворачивается на этом сервере.
Можно сразу включить https для домена ноды.

При регистрации ноды тебе предложат **как её подключить к внутренним сквадам панели**:

- только к одному «основному» внутреннему скваду,
- или сразу ко всем внутренним сквадам панели.

### 2.4. Нода на другой сервер через Skynet

Если у тебя настроен Skynet и есть флот серверов, можно ставить ноды удалённо.

**Один сервер:**

1. В Remnawave‑меню выбери `Ноды Remnawave`.
2. Пункт для установки ноды через Skynet на один сервер.
3. Мастер попросит:
   - адрес панели и API‑токен,
   - домен ноды,
   - имя ноды,
   - на какой сервер из флота всё поставить.
4. Выберешь, нужен ли https прямо на удалённой ноде.
5. Выберешь режим подключения к внутренним сквадам панели (один или все).

Скрипт:
- зарегистрирует ноду в панели,
- получит ключи,
- запустит скрытый плагин Skynet на выбранном сервере,
- поднимет там docker‑стек ноды.

**Несколько серверов сразу:**

Для раздачи нод на несколько машин из флота есть отдельный пункт
(массовая установка). Там логика та же, только мастер:
- даёт выбрать сразу несколько серверов, 
- один раз спрашивает режим подключения к внутренним сквадам,
- дальше разворачивает ноды по списку.

---

## 3. Как управлять уже установленной Remnawave

В Remnawave‑меню есть раздел **«Управление панелью/нодой»**.

Через него можно:

- Запустить или остановить панель / локальную ноду.
- Обновить их до свежих образов (перезапуск произойдёт автоматически).
- Посмотреть логи в прямом эфире и вернуться по `CTRL+C`.

Отдельное меню **«Управление сертификатами Remnawave»** помогает:

- проверить, правильно ли домен смотрит на сервер,
- посмотреть, есть ли действующий сертификат,
- посмотреть срок его действия.

---

## 4. Кастомные подписки и страница выдачи

Раздел **«Кастомные подписки от Legiz»** даёт:

1. Поменять заголовок и описание страницы подписки (то, что видит пользователь в браузере).
2. Выбрать готовый шаблон страницы подписки (Orion, Material, простая страница и т.п.).
3. Включить или выключить отдельный конфиг приложений `app-config.json`.
4. Настроить брендирование: название проекта, логотип, ссылку на поддержку.
5. Удалить лишние приложения из списка для конкретных платформ.

Все изменения применяются аккуратно: переписывается конфигурация,
перезапускается только страница подписки, панель не трогаем.

---

## 5. Если нужно переустановить

Раздел **«Переустановить панель/ноду»** позволяет:

- переустановить панель+ноду на один сервер,
- переустановить только панель,
- переустановить только локальную ноду.

Мастера в этом разделе:

- аккуратно останавливают связанные сервисы,
- при желании очищают каталоги `/opt/remnawave` и `/opt/remnanode`,
- после чего запускают соответствующие мастера установки из раздела «Установка компонентов».

Если всё настроено неправильно и хочется начать с нуля — это самый безопасный путь.
