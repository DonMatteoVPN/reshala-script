#!/bin/bash
# ============================================================ #
# ==           REMNAWAVE: –£–°–¢–ê–ù–û–í–ö–ê –ö–û–ú–ü–û–ù–ï–ù–¢–û–í             == #
# ============================================================ #
# –ü–æ–¥–º–µ–Ω—é "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Remnawave".

[[ "${BASH_SOURCE[0]}" == "${0}" ]] && exit 1

show_remnawave_install_menu() {
    enable_graceful_ctrlc
    while true; do
        clear
        menu_header "–£–°–¢–ê–ù–û–í–ö–ê –ö–û–ú–ü–û–ù–ï–ù–¢–û–í REMNAWAVE"
        echo
        echo "   1) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ü–ê–ù–ï–õ–¨ –∏ –ù–û–î–£ –Ω–∞ –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä"
        echo "   2) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¢–û–õ–¨–ö–û –ü–ê–ù–ï–õ–¨ –Ω–∞ —ç—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä"
        echo "   3) –î–æ–±–∞–≤–∏—Ç—å –ù–û–î–£ –≤ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ø–∞–Ω–µ–ª—å (—Ä–µ–∂–∏–º add_node_to_panel)"
        echo "   4) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¢–û–õ–¨–ö–û –ù–û–î–£ (–¥–ª—è —É–∂–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–π –ø–∞–Ω–µ–ª–∏)"
        echo
        echo "   [b] üîô –ù–∞–∑–∞–¥"
        echo "------------------------------------------------------"

        local choice
        choice=$(safe_read "–¢–≤–æ–π –≤—ã–±–æ—Ä: " "") || break

        case "$choice" in
            1)
                # –í—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â–∏–π –º–∞—Å—Ç–µ—Ä-–≤–∏–∑–∞—Ä–¥ –∏–∑ remnawave_panel_node
                run_module remnawave_panel_node _remna_install_panel_and_node_wizard
                ;;
            2)
                # –í—Ä–µ–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–∏–∑–∞—Ä–¥ –ø–∞–Ω–µ–ª–∏-only
                run_module remnawave_panel _remna_panel_install_wizard
                ;;
            3)
                # –ù–æ–≤—ã–π –ø–æ—Ç–æ–∫ add_node_to_panel: —Å–æ–∑–¥–∞—ë–º –Ω–æ–¥—É —Ç–æ–ª—å–∫–æ –≤ –ø–∞–Ω–µ–ª–∏ —á–µ—Ä–µ–∑ HTTP API
                run_module remnawave_node _remna_node_add_to_panel_wizard
                ;;
            4)
                # –í—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π –≤–∏–∑–∞—Ä–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–æ–¥—ã –ø–æ–¥ API –ø–∞–Ω–µ–ª–∏
                run_module remnawave_node _remna_node_install_local_wizard
                ;;
            [bB])
                break
                ;;
            *)
                err "–ù–µ—Ç —Ç–∞–∫–æ–≥–æ –ø—É–Ω–∫—Ç–∞, —Å–º–æ—Ç—Ä–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ, –±–æ—Å—Å."
                ;;
        esac
    done
    disable_graceful_ctrlc
}
