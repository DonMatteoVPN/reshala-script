#!/bin/bash
# ============================================================ #
# ==      REMNAWAVE: –®–ê–ë–õ–û–ù–´ –ú–ê–°–ö–ò–†–û–í–ö–ò –î–õ–Ø SELFSTEAL        == #
# ============================================================ #
# –ú–µ–Ω—é –≤—ã–±–æ—Ä–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏ selfsteal-–Ω–æ–¥—ã.
# –õ–æ–≥–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≤—è–∑–∞–Ω–∞ –Ω–∞ remask.sh –∏ randomhtml-–ø–æ–¥–æ–±–Ω–æ–º –º–µ—Ö–∞–Ω–∏–∑–º–µ.

[[ "${BASH_SOURCE[0]}" == "${0}" ]] && exit 1

show_remnawave_templates_menu() {
    enable_graceful_ctrlc
    while true; do
        clear
        menu_header "–®–ê–ë–õ–û–ù–´ –î–õ–Ø SELFSTEAL-–ù–û–î–´ REMNAWAVE"
        echo
        echo "   1) Simple web templates (–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Å–∞–π—Ç—ã)"
        echo "   2) SNI templates (–Ω–∞–±–æ—Ä –º–∞—Å–æ–∫ –ø–æ–¥ SNI)"
        echo "   3) Nothing Sni templates (—Ä–∞–Ω–¥–æ–º–Ω—ã–µ –æ–¥–∏–Ω–æ—á–Ω—ã–µ HTML)"
        echo
        echo "   [b] üîô –ù–∞–∑–∞–¥"
        echo "------------------------------------------------------"

        local choice
        choice=$(safe_read "–¢–≤–æ–π –≤—ã–±–æ—Ä: " "") || break

        case "$choice" in
            1|2|3)
                local script="/opt/remnanode/tools/remask.sh"
                if [[ ! -x "$script" ]]; then
                    err "–ù–µ –Ω–∞—à—ë–ª $script. –ü–æ—Ö–æ–∂–µ, –ª–æ–∫–∞–ª—å–Ω–∞—è –Ω–æ–¥–∞ –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∏–ª–∏ remask.sh –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω."
                    info "–°–Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏ –ª–æ–∫–∞–ª—å–Ω—É—é –Ω–æ–¥—É Remnawave —á–µ—Ä–µ–∑ –º–µ–Ω—é —É—Å—Ç–∞–Ω–æ–≤–∫–∏, —á—Ç–æ–±—ã –ø–æ—è–≤–∏–ª—Å—è remask.sh."
                    wait_for_enter || true
                    continue
                fi

                local src
                case "$choice" in
                    1) src="simple" ;;
                    2) src="sni"    ;;
                    3) src="nothing";;
                esac

                info "–û–±–Ω–æ–≤–ª—è—é –º–∞—Å–∫–∏—Ä–æ–≤–æ—á–Ω—ã–π —Å–∞–π—Ç selfsteal-–Ω–æ–¥—ã (–∏—Å—Ç–æ—á–Ω–∏–∫ —à–∞–±–ª–æ–Ω–æ–≤: $src)..."
                if REMASK_SOURCE="$src" "$script"; then
                    ok "–ú–∞—Å–∫–∏—Ä–æ–≤–æ—á–Ω—ã–π —Å–∞–π—Ç –¥–ª—è selfsteal-–¥–æ–º–µ–Ω–∞ –æ–±–Ω–æ–≤–ª—ë–Ω –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –Ω–∞–±–æ—Ä—É —à–∞–±–ª–æ–Ω–æ–≤ ($src)."
                    info "–§–∞–π–ª—ã –ª–µ–∂–∞—Ç –≤ /var/www/html ‚Äî –º–æ–∂–µ—à—å –∑–∞–≥–ª—è–Ω—É—Ç—å —Ç—É–¥–∞, –µ—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ."
                else
                    err "remask.sh –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π. –ü—Ä–æ–≤–µ—Ä—å –≤—ã–≤–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞ –∏ –¥–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç/–ø—Ä–∞–≤–∞."
                fi
                wait_for_enter || true
                ;;
            [bB])
                break
                ;;
            *)
                err "–ù–µ—Ç —Ç–∞–∫–æ–≥–æ –ø—É–Ω–∫—Ç–∞, —Å–º–æ—Ç—Ä–∏ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ, –±–æ—Å—Å."
                ;;
        esac
    done
    disable_graceful_ctrlc
}
